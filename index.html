<!DOCTYPE html>
<html>
<head>
    <title>Monster Hunter Random Hunts</title>
    <meta name="description" content="A randomizer for Monster Hunter Wilds">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atma:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preload" as="image" href="damage types\ammo\Normal.png">
    <link rel="preload" as="image" href="damage types\ammo\Pierce.png">
    <link rel="preload" as="image" href="damage types\ammo\Spread.png">
    <link rel="preload" as="image" href="damage types\ammo\Sticky.png">
    <link rel="preload" as="image" href="damage types\element\Dragon.png">
    <link rel="preload" as="image" href="damage types\element\Fire.png">
    <link rel="preload" as="image" href="damage types\element\Ice.png">
    <link rel="preload" as="image" href="damage types\element\Thunder.png">
    <link rel="preload" as="image" href="damage types\element\Water.png">
    <link rel="preload" as="image" href="damage types\shells\Long.png">
    <link rel="preload" as="image" href="damage types\shells\Normal.png">
    <link rel="preload" as="image" href="damage types\shells\Wide.png">
    <link rel="preload" as="image" href="damage types\status\Blast.png">
    <link rel="preload" as="image" href="damage types\status\Paralysis.png">
    <link rel="preload" as="image" href="damage types\status\Poison.png">
    <link rel="preload" as="image" href="damage types\status\Sleep.png">
    <link rel="preload" as="image" href="damage types\Raw.png">
    <link rel="preload" as="image" href="monster\Ajarakan.png">
    <link rel="preload" as="image" href="monster\Arkveld.png">
    <link rel="preload" as="image" href="monster\Balahara.png">
    <link rel="preload" as="image" href="monster\Blangonga.png">
    <link rel="preload" as="image" href="monster\Chatacabra.png">
    <link rel="preload" as="image" href="monster\Congalala.png">
    <link rel="preload" as="image" href="monster\Doshugama.png">
    <link rel="preload" as="image" href="monster\Gore Magala.png">
    <link rel="preload" as="image" href="monster\Gravios.png">
    <link rel="preload" as="image" href="monster\Guardian Doshaguma.png">
    <link rel="preload" as="image" href="monster\Guardian Ebony Odogaron.png">
    <link rel="preload" as="image" href="monster\Guardian Fulgur Anjanath.png">
    <link rel="preload" as="image" href="monster\Guardian Rathalos.png">
    <link rel="preload" as="image" href="monster\Gypceros.png">
    <link rel="preload" as="image" href="monster\Hirabami.png">
    <link rel="preload" as="image" href="monster\Jin Dahaad.png">
    <link rel="preload" as="image" href="monster\Lagiacrus.png">
    <link rel="preload" as="image" href="monster\Lala Barina.png">
    <link rel="preload" as="image" href="monster\Mizutsune.png">
    <link rel="preload" as="image" href="monster\Nerscylla.png">
    <link rel="preload" as="image" href="monster\Nu Udra.png">
    <link rel="preload" as="image" href="monster\Quematrice.png">
    <link rel="preload" as="image" href="monster\Rathalos.png">
    <link rel="preload" as="image" href="monster\Rathian.png">
    <link rel="preload" as="image" href="monster\Rey Dau.png">
    <link rel="preload" as="image" href="monster\Rompopolo.png">
    <link rel="preload" as="image" href="monster\Seregios.png">
    <link rel="preload" as="image" href="monster\Unknown.png">
    <link rel="preload" as="image" href="monster\Uth Duna.png">
    <link rel="preload" as="image" href="monster\Xu Wu.png">
    <link rel="preload" as="image" href="monster\Yian Kut-Ku.png">
    <link rel="preload" as="image" href="monster\Zoh Shia.png">
    <link rel="preload" as="image" href="weapon\Bow.png">
    <link rel="preload" as="image" href="weapon\Charge Blade.png">
    <link rel="preload" as="image" href="weapon\Dual Blades.png">
    <link rel="preload" as="image" href="weapon\Great Sword.png">
    <link rel="preload" as="image" href="weapon\Gunlance.png">
    <link rel="preload" as="image" href="weapon\Hammer.png">
    <link rel="preload" as="image" href="weapon\Heavy Bowgun.png">
    <link rel="preload" as="image" href="weapon\Hunting Horn.png">
    <link rel="preload" as="image" href="weapon\Insect Glaive.png">
    <link rel="preload" as="image" href="weapon\Lance.png">
    <link rel="preload" as="image" href="weapon\Light Bowgun.png">
    <link rel="preload" as="image" href="weapon\Long Sword.png">
    <link rel="preload" as="image" href="weapon\Switch Axe.png">
    <link rel="preload" as="image" href="weapon\Sword and Shield.png">

    <style>
        body {
            margin: 0;
            background-size: 100vw 100vh;
            font-family: "Atma";
        }

        .content {
            text-align: center;
            background-color: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(7px);
            height: 100%;
            min-height: 100vh;
            width: 100%;
        }

        .item {
            max-width: 256px;
            width: 12vw;
        }

        .row {
            padding: 1vh 0px;
        }

        @media screen and (max-width: 600px) {
            .label {
                font-size: 12px;
            }
            
        }

        .label {
            background-color: #e6c6ff;
            width: 300px;
            margin: auto;
            font-size: large;
            border-radius: 100px;
            border-color: rebeccapurple;
            border-width: 7px;
            border-style: solid;
            max-width: 90vw;
        }

        #result {
            width: 600px;
        }

        button {
            background-color: #e6c6ff;
            font-weight: bold;
            font-size: 24px !important;
            border-radius: 100px;
            border: 7px rebeccapurple solid;
            font-family: "Atma";
            cursor: pointer;
        }
        button:hover {
            background-color: #f0ddff;
        }

        .element {
            display: inline-block;
        }

        #title-image {
            max-width: 40vw;
            min-width: 400px;
        }
    </style>

</head>

<body id="body" background="backgrounds/BG6.png">
    <div class="content">
        <div class="row">
            <img src="Title.png" id="title-image">
        </div>
        <div class="row">
            <img src="monster/Unknown.png" class="item" id="monster">
            <div id="monster-label" class="label">?</div>
        </div>
        <div class="row">
            <span class="element">
                <img src="monster/Unknown.png" class="item" id="damage">
                <div id="damage-label" class="label">?</div>
            </span>
            <span class="element">
                <img src="monster/Unknown.png" class="item" id="weapon">
                <div id="weapon-label" class="label">?</div>
            </span>
        </div>
        <div class="row">
            <div id="result" class="label">?</div>
        </div>
        <div class="row">
            <button id="randomize" class="label">
                Randomize all!
            </button>
        </div>
        <div class="row">
            <button id="randomize-weapon" class="label">
                Randomize weapon
            </button>
            <button id="randomize-monster" class="label">
                Randomize monster
            </button>
        </div>
    </div>

    <script>
        let monsters = [
            "Ajarakan",
            "Arkveld",
            "Balahara",
            "Blangonga",
            "Chatacabra",
            "Congalala",
            "Doshugama",
            "Gore Magala",
            "Gravios",
            "Guardian Doshaguma",
            "Guardian Ebony Odogaron",
            "Guardian Fulgur Anjanath",
            "Guardian Rathalos",
            "Gypceros",
            "Hirabami",
            "Jin Dahaad",
            "Lagiacrus",
            "Lala Barina",
            "Mizutsune",
            "Nerscylla",
            "Nu Udra",
            "Quematrice",
            "Rathalos",
            "Rathian",
            "Rey Dau",
            "Rompopolo",
            "Seregios",
            "Uth Duna",
            "Xu Wu",
            "Yian Kut-Ku",
            "Zoh Shia",
        ];
        let weapons = [
            "Bow",
            "Charge Blade",
            "Dual Blades",
            "Great Sword",
            "Gunlance",
            "Hammer",
            "Heavy Bowgun",
            "Hunting Horn",
            "Insect Glaive",
            "Lance",
            "Light Bowgun",
            "Long Sword",
            "Switch Axe",
            "Sword and Shield",
        ];
        let ammo = [
            "Normal",
            "Pierce",
            "Spread",
            "Sticky",
        ];
        let shells = [
            "Long",
            "Normal",
            "Wide",
        ];
        let elements = [
            "Dragon",
            "Fire",
            "Ice",
            "Thunder",
            "Water",
        ];
        let status = [
            "Blast",
            "Paralysis",
            "Poison",
            "Sleep",
        ];

        let backgroundIndex = Math.floor(Math.random() * 16) + 1;
        document.getElementById("body").background = "backgrounds/BG" + backgroundIndex + ".png";

        let audioContext = new AudioContext();
        let audio;
        let drumrollAudioBuffer;
        let crashAudioBuffer;
        let moanAudioBuffer;
        let startAudio = (audioBuffer, loop) => {
            audio = audioContext.createBufferSource();
            audio.buffer = audioBuffer;
            audio.connect(audioContext.destination);
            audio.loop = loop;
            audio.start();
        }
        fetch("drumroll.wav").then(result => {
            return result.arrayBuffer();
        }).then(buffer => {
            audioContext.decodeAudioData(buffer, (decodedBuffer) => {
                drumrollAudioBuffer = decodedBuffer;
            });
        });
        fetch("crash.wav").then(result => {
            return result.arrayBuffer();
        }).then(buffer => {
            audioContext.decodeAudioData(buffer, (decodedBuffer) => {
                crashAudioBuffer = decodedBuffer;
            });
        });
        fetch("moan.wav").then(result => {
            return result.arrayBuffer();
        }).then(buffer => {
            audioContext.decodeAudioData(buffer, (decodedBuffer) => {
                moanAudioBuffer = decodedBuffer;
            });
        });

        let chosen = {
            weapon: "Unknown",
            monster: "Unknown",
            damage: "Unknown",
            damageTypeName: "Damage types",
        };
        let spin = (types) => {
            if (audio) {
                audio.stop();
            }
            let monsterStop = 200;
            let allStop = 380;
            startAudio(drumrollAudioBuffer, true);
            let animationCounter = 0;
            if (!types.includes("weapon")) {
                allStop = monsterStop;
            }
            let setRandomAnimation = () => {
                let randomSelection = pickRandomImages();
                animationCounter += 1;
                if (animationCounter < monsterStop && types.includes("monster")) {
                    chosen.monster = randomSelection.monster;
                }
                if (animationCounter < allStop && types.includes("weapon")) {
                    chosen.damage = randomSelection.damage;
                    chosen.damageTypeName = randomSelection.damageTypeName;
                    chosen.weapon = randomSelection.weapon;
                }
                setImage("weapon", chosen.weapon, "weapon");
                setImage("monster", chosen.monster, "monster");
                setImage(chosen.damageTypeName, chosen.damage, "damage");
                let naked;
                if (animationCounter < allStop) {
                    window.setTimeout(setRandomAnimation, 10);
                } else {
                    audio.stop();
                    if (Math.random() > 0.95) {
                        // Hunt it naked!
                        naked = true;
                        document.querySelectorAll(".label").forEach(label => {
                            label.style.borderColor = "rgb(148, 0, 0)";
                            label.style.backgroundColor = "#ffa9a9";
                        });
                    } else {
                        naked = false;
                        document.querySelectorAll(".label").forEach(label => {
                            label.style.borderColor = "";
                            label.style.backgroundColor = "";
                        });
                    }
                    startAudio(naked ? moanAudioBuffer : crashAudioBuffer, false);
                }
                let nakedText = naked ? " NAKED" : "";
                document.getElementById("result").innerText =
                    `Hunt ${chosen.monster} with ${chosen.damage} ${chosen.weapon}${nakedText}!`;
            };
            setRandomAnimation();
        };
        document.getElementById("randomize").addEventListener("click", spin.bind(this, ["monster", "weapon"]));
        document.getElementById("randomize-weapon").addEventListener("click", spin.bind(this, ["weapon"]));
        document.getElementById("randomize-monster").addEventListener("click", spin.bind(this, ["monster"]));

        function pickRandomImages() {
            let monster = randomize("monster", monsters, "monster");
            let weapon = randomize("weapon", weapons, "weapon");
            let damage;
            let damageType = Math.floor(Math.random() * 3);
            let damageTypeName;
            switch (damageType) {
                case 0: {
                    // Raw
                    if (weapon == "Light Bowgun" || weapon == "Heavy Bowgun") {
                        damageTypeName = "damage types/ammo";
                        damage = randomize(damageTypeName, ammo, "damage");
                    } else if (weapon == "Gunlance") {
                        damageTypeName ="damage types/shells";
                        damage = randomize(damageTypeName, shells, "damage");
                    } else {
                        damageTypeName ="damage types";
                        damage = randomize(damageTypeName, ["Raw"], "damage");
                    }
                    break;
                }
                case 1: {
                    // elements
                    damageTypeName ="damage types/element";
                    damage = randomize(damageTypeName, elements, "damage");
                    break;
                }
                case 2: {
                    // Status
                    damageTypeName = "damage types/status";
                    damage = randomize(damageTypeName, status, "damage");
                    break;
                }
            }
            return {
                weapon, monster, damage, damageTypeName
            };
        }

        function setImage(type, element, inputName) {
            let image = document.getElementById(inputName);
            let label = document.getElementById(inputName + "-label");
            label.innerText = element;
            image.src = type + "/" + element + ".png";
        }

        function randomize(type, list, inputName) {
            return list[Math.floor(Math.random() * list.length)];
        }
    </script>

</body>

</html>