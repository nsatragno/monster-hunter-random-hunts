<!DOCTYPE html>
<html>

<head>
    <style>
        body {
            background-size: 100vw 100vh;
        }

        .content {
            text-align: center;
        }

        .item {
            width: 256px;
            margin: 0px 30px;
        }

        .row {
            margin: 20px 0px;
        }

        .label {
            background-color: white;
            width: 300px;
            margin: auto;
        }

        #result {
            width: 600px;
        }

        .element {
            display: inline-block;
        }

        table {
            width: 100%;
            background-color: white;
        }

        table th {
            width: 33%;
        }
    </style>

</head>

<body id="body" background="Backgrounds/BG6.png">
    <img src="Title.png">
    <div class="content">
        <div class="row">
            <img src="Monster/Unknown.png" class="item" id="monster">
            <div id="monster-label" class="label">?</div>
        </div>
        <div class="row">
            <span class="element">
                <img src="monster/Unknown.png" class="item" id="damage">
                <div id="damage-label" class="label">?</div>
            </span>
            <span class="element">
                <img src="Monster/Unknown.png" class="item" id="weapon">
                <div id="weapon-label" class="label">?</div>
            </span>
        </div>
        <div class="row">
            <div id="result" class="label">?</div>
        </div>
        <div>
            <button id="randomize">
                Randomize!
            </button>
        </div>

        <div>
            <h1 style="color: white">History</h1>
            <table>
                <thead>
                    <tr>
                        <th>Monster</th>
                        <th>Damage</th>
                        <th>Weapon</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        let monsters = [
            "Ajarakan",
            "Arkveld",
            "Balahara",
            "Blangonga",
            "Chatacabra",
            "Congalala",
            "Doshugama",
            "Gore Magala",
            "Gravios",
            "Guardian Doshaguma",
            "Guardian Ebony Odogaron",
            "Guardian Fulgur Anjanath",
            "Guardian Rathalos",
            "Gypceros",
            "Hirabami",
            "Jin Dahaad",
            "Lala Barina",
            "Nerscylla",
            "Nu Udra",
            "Quematrice",
            "Rathalos",
            "Rathian",
            "Rey Dau",
            "Rompopolo",
            "Uth Duna",
            "Xu Wu",
            "Yian Kut-Ku",
        ];
        let weapons = [
            "Bow",
            "Charge Blade",
            "Dual Blades",
            "Great Sword",
            "Gunlance",
            "Hammer",
            "Heavy Bowgun",
            "Hunting Horn",
            "Insect Glaive",
            "Lance",
            "Light Bowgun",
            "Long Sword",
            "Switch Axe",
            "Sword and Shield",
        ];
        let ammo = [
            "Normal",
            "Pierce",
            "Spread",
            "Sticky",
        ];
        let shells = [
            "Long",
            "Normal",
            "Wide",
        ];
        let elements = [
            "Dragon",
            "Fire",
            "Ice",
            "Thunder",
            "Water",
        ];
        let status = [
            "Blast",
            "Paralysis",
            "Poison",
            "Sleep",
        ];

        let drumroll = new Audio("drumroll.wav");
        const monsterStop = 200;
        const allStop = 380;
        document.getElementById("randomize").addEventListener("click", () => {
            drumroll.play();
            let animationCounter = 0;
            let final = pickRandomImages();
            let setRandomAnimation = () => {
                let chosen = pickRandomImages();
                animationCounter += 1;
                if (animationCounter >= monsterStop) {
                    chosen.monster = final.monster;
                }
                if (animationCounter >= allStop) {
                    chosen.damage = final.damage;
                    chosen.damageTypeName = final.damageTypeName;
                    chosen.weapon = final.weapon;
                }
                document.getElementById("result").innerText =
                    `Hunt ${chosen.monster} with ${chosen.damage} ${chosen.weapon}!`;
                setImage("weapon", chosen.weapon, "weapon");
                setImage("monster", chosen.monster, "monster");
                setImage(chosen.damageTypeName, chosen.damage, "damage");
                if (animationCounter < allStop) {
                    window.setTimeout(setRandomAnimation, 10);
                } else {
                    loadTable([final]);
                }
            };
            setRandomAnimation();
        });

        function pickRandomImages() {
            let monster = randomize("monster", monsters, "monster");
            let weapon = randomize("weapon", weapons, "weapon");
            let damage;
            let damageType = Math.floor(Math.random() * 3);
            let damageTypeName;
            switch (damageType) {
                case 0: {
                    // Raw
                    if (weapon == "Light Bowgun" || weapon == "Heavy Bowgun") {
                        damageTypeName = "Damage Types/Ammo";
                        damage = randomize(damageTypeName, ammo, "damage");
                    } else if (weapon == "Gunlance") {
                        damageTypeName ="Damage Types/Shells";
                        damage = randomize(damageTypeName, shells, "damage");
                    } else {
                        damageTypeName ="Damage Types";
                        damage = randomize(damageTypeName, ["Raw"], "damage");
                    }
                    break;
                }
                case 1: {
                    // Elements
                    damageTypeName ="Damage Types/Element";
                    damage = randomize(damageTypeName, elements, "damage");
                    break;
                }
                case 2: {
                    // Status
                    damageTypeName = "Damage Types/Status";
                    damage = randomize(damageTypeName, status, "damage");
                    break;
                }
            }
            return {
                weapon, monster, damage, damageTypeName
            };
        }

        function setImage(type, element, inputName) {
            let image = document.getElementById(inputName);
            let label = document.getElementById(inputName + "-label");
            label.innerText = element;
            image.src = type + "/" + element + ".png";
        }

        function randomize(type, list, inputName) {
            return list[Math.floor(Math.random() * list.length)];
        }

        function loadTable(list) {
            let body = document.getElementById("table-body");
            for (let element of list) {
                let tr = document.createElement("tr");
                if (body.children.length > 0) {
                    body.insertBefore(tr, body.firstChild);
                } else {
                    body.appendChild(tr);
                }
                let monster = document.createElement("td");
                monster.innerText = element.monster;
                tr.appendChild(monster);
                let damage = document.createElement("td");
                damage.innerText = element.damage;
                tr.appendChild(damage);
                let weapon = document.createElement("td");
                weapon.innerText = element.weapon;
                tr.appendChild(weapon);
            }
        };
    </script>

</body>

</html>